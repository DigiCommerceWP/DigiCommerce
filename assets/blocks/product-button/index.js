(()=>{var{InspectorControls:V,useBlockProps:D,__experimentalUseColorProps:E,__experimentalUseBorderProps:R,__experimentalGetSpacingClassesAndStyles:W}=window.wp.blockEditor,{PanelBody:$,TextControl:M,ToggleControl:B,SelectControl:S,RadioControl:O,Notice:j}=window.wp.components,{__:o}=window.wp.i18n,{useState:G,useEffect:U,useMemo:F}=window.wp.element,{useSelect:q}=window.wp.data,H=({attributes:i,setAttributes:t})=>{let{productId:a,buttonText:p,showPrice:m,openInNewTab:I,actionType:g,variationId:u}=i,[h,d]=G([]),C=D(),c={...C,style:{...C.style,padding:void 0,paddingTop:void 0,paddingRight:void 0,paddingBottom:void 0,paddingLeft:void 0}};c.className&&(c.className=c.className.split(" ").filter(e=>!e.includes("has-")||!e.includes("-padding")).join(" "));let f=E(i),y=R(i),r=W(i),n={...f.style,...y.style,...r.style&&{padding:r.style.padding,paddingTop:r.style.paddingTop,paddingRight:r.style.paddingRight,paddingBottom:r.style.paddingBottom,paddingLeft:r.style.paddingLeft},...i.style?.typography&&i.style.typography,...i.fontSize&&{fontSize:`var(--wp--preset--font-size--${i.fontSize})`}},_=n.borderWidth||n.borderTopWidth||n.borderRightWidth||n.borderBottomWidth||n.borderLeftWidth||i.style?.border?.width,k=n.borderStyle||i.style?.border?.style;_&&!k&&(n.borderStyle="solid");let w={className:["wp-element-button",f.className,y.className].filter(Boolean).join(" ").trim(),style:n};i.fontSize&&(w.className+=` has-${i.fontSize}-font-size`);let l=q(e=>e("core").getEntityRecords("postType","digi_product",{per_page:-1,status:"publish"}),[]),N=F(()=>l?[{value:0,label:o("Select a product","digicommerce")},...l.map(e=>({value:e.id,label:e.title.rendered||e.title.raw||o("(No title)","digicommerce")}))]:[],[l]);U(()=>{a>0?window.wp.apiFetch({path:`/wp/v2/digi_product/${a}`,method:"GET"}).then(e=>{let x=e.meta?.digi_price_mode,s=e.meta?.digi_price_variations;if(x==="variations"&&Array.isArray(s)&&s.length>0){let z=s.map((L,P)=>({value:P,label:L.name||`Variation ${P+1}`}));d(z),u===-1&&t({variationId:0})}else d([]),t({variationId:-1})}).catch(()=>{d([]),t({variationId:-1})}):(d([]),t({variationId:-1}))},[a]);let v=p||o("View Product","digicommerce");return m&&(v+=" - $19.99"),wp.element.createElement(wp.element.Fragment,null,wp.element.createElement(V,null,wp.element.createElement($,{title:o("Settings","digicommerce"),initialOpen:!0},wp.element.createElement("div",{style:{marginBottom:"1rem"}},wp.element.createElement(j,{status:"warning",isDismissible:!1},wp.element.createElement("p",{style:{margin:0}},o("This is a preview. The actual button will work on the frontend.","digicommerce")))),wp.element.createElement(S,{label:o("Select Product","digicommerce"),value:a,options:N,onChange:e=>t({productId:parseInt(e),variationId:-1})}),a>0&&wp.element.createElement(wp.element.Fragment,null,wp.element.createElement(O,{label:o("Button Action","digicommerce"),selected:g,options:[{label:o("Link to Product Page","digicommerce"),value:"link"},{label:o("Direct to Checkout","digicommerce"),value:"checkout"}],onChange:e=>t({actionType:e})}),h.length>0&&g==="checkout"&&wp.element.createElement(S,{label:o("Select Variation","digicommerce"),value:u,options:h,onChange:e=>t({variationId:parseInt(e)})})),wp.element.createElement(M,{label:o("Button Text","digicommerce"),value:p,onChange:e=>t({buttonText:e}),placeholder:o("View Product","digicommerce")}),wp.element.createElement(B,{label:o("Show Price","digicommerce"),checked:m,onChange:e=>t({showPrice:e})}),wp.element.createElement(B,{label:o("Open in New Tab","digicommerce"),checked:I,onChange:e=>t({openInNewTab:e})}))),wp.element.createElement("div",{...c},wp.element.createElement("button",{...w},v)))},b=H;var J=()=>null,T=J;var{registerBlockType:K}=window.wp.blocks;K("digicommerce/product-button",{icon:{src:wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",width:"24",height:"24","aria-hidden":"true",focusable:"false"},wp.element.createElement("path",{d:"M373.1 156.5C381.3 163.4 388.8 171 395.7 179.2C415.5 161.8 441 152.1 467.5 152.1C527.4 152.1 576 200.7 576 260.6C576 289.4 564.6 316.9 544.2 337.3L465.1 416.4C444.8 436.7 417.2 448.2 388.4 448.2C328.5 448.2 279.9 399.6 279.9 339.7C279.9 324.1 283.3 308.8 289.6 294.8C293.3 286.8 289.7 277.3 281.7 273.6C273.7 269.9 264.2 273.5 260.5 281.5C252.3 299.6 247.9 319.4 247.9 339.7C247.9 417.3 310.8 480.2 388.4 480.2C425.6 480.2 461.4 465.4 487.7 439.1L566.8 360C593.1 333.7 607.9 297.9 607.9 260.7C607.9 183.1 545 120.2 467.4 120.2C432.4 120.2 398.8 133.3 373 156.7zM251.5 192C311.4 192 360 240.6 360 300.5C360 316.1 356.6 331.4 350.3 345.4C346.6 353.4 350.2 362.9 358.2 366.6C366.2 370.3 375.7 366.7 379.4 358.7C387.6 340.6 392 320.8 392 300.5C392 222.9 329.1 160 251.5 160C214.3 160 178.5 174.8 152.2 201.1L73.1 280.2C46.8 306.5 32 342.3 32 379.5C32 457.1 94.9 520 172.5 520C207.5 520 241.1 506.9 266.9 483.5C258.7 476.6 251.2 469 244.3 460.8C224.5 478.2 199 487.9 172.5 487.9C112.6 487.9 64 439.3 64 379.4C64 350.6 75.4 323.1 95.8 302.7L174.9 223.6C195.2 203.3 222.8 191.8 251.6 191.8z"})),foreground:"#ccb161"},edit:b,save:T});})();
