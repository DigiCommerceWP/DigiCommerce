(()=>{var{__:u}=wp.i18n,{useBlockProps:R,InspectorControls:U}=wp.blockEditor,{PanelBody:j,SelectControl:H,TextControl:z,ToggleControl:O}=wp.components;function D({attributes:$,setAttributes:i}){let{productId:h,customTitle:f,showPrice:y,subtitle:_,customClass:C,variationId:p}=$,g=R(),v=["dc-button",C].filter(Boolean),w=window.digicommerceBlocksData?.products||[],N=window.digicommerceBlocksData?.currencies||{},k=window.digicommerceBlocksData?.selectedCurrency||"USD",F=window.digicommerceBlocksData?.currencyPosition||"left",b=N[k]?.symbol||"$",s=w.find(e=>e.value===h),l=s?.variations||[],B=l.length>0,m=B&&p?l[parseInt(p)-1]:null,t=(e,o=null)=>{if(!e&&e!==0)return"";let a=parseFloat(e).toFixed(2),P=a;if(o&&parseFloat(o)>0&&parseFloat(o)<parseFloat(e)){let x=parseFloat(o).toFixed(2),S=c(a);return`${c(x)} <del>${S}</del>`}return c(P)},c=e=>{switch(F){case"left":return`${b}${e}`;case"right":return`${e}${b}`;case"left_space":return`${b} ${e}`;case"right_space":return`${e} ${b}`;default:return`${b}${e}`}},r=f||s?.label||u("Buy Now","digicommerce");if(y&&s)if((s?.variations||[]).length>0){if(m){let a=t(m.price,m.salePrice);r+=` - ${a}`}}else{let a=t(s.price,s.sale_price);r+=` - ${a}`}return React.createElement(React.Fragment,null,React.createElement(U,null,React.createElement(j,{title:u("Button Settings","digicommerce")},React.createElement(H,{label:u("Select Product","digicommerce"),value:h||"",options:[{label:u("Select a product...","digicommerce"),value:""},...w],onChange:e=>{i({productId:e?parseInt(e):null,variationId:""})},__nextHasNoMarginBottom:!0}),B&&React.createElement(H,{label:u("Select Variation","digicommerce"),value:p||"",options:[{label:u("Select a variation...","digicommerce"),value:""},...l.map((e,o)=>({label:e.name,value:(o+1).toString()}))],onChange:e=>i({variationId:e}),__nextHasNoMarginBottom:!0}),React.createElement(z,{label:u("Custom Button Text","digicommerce"),value:f||"",onChange:e=>i({customTitle:e}),help:u("Leave empty to use product name","digicommerce"),__nextHasNoMarginBottom:!0}),React.createElement(O,{label:u("Show Price","digicommerce"),checked:!!y,onChange:e=>i({showPrice:e}),__nextHasNoMarginBottom:!0}),React.createElement(z,{label:u("Subtitle","digicommerce"),value:_||"",onChange:e=>i({subtitle:e}),__nextHasNoMarginBottom:!0}),React.createElement(z,{label:u("Custom Class","digicommerce"),value:C||"",onChange:e=>i({customClass:e}),help:u("Add custom CSS classes to the button","digicommerce"),__nextHasNoMarginBottom:!0}))),React.createElement("div",{className:"dc-button-wrapper"},React.createElement("a",{...g,href:"#",className:[...v,g.className].filter(Boolean).join(" "),onClick:e=>e.preventDefault()},React.createElement("span",{className:"dc-button-text",dangerouslySetInnerHTML:{__html:r}}),_&&React.createElement("span",{className:"dc-button-subtitle"},_))))}var{__:q}=wp.i18n,{useBlockProps:G}=wp.blockEditor;function I({attributes:$,clientId:i}){let{productId:h,customTitle:f,showPrice:y,subtitle:_,customClass:C,variationId:p}=$,g=G.save(),v=["dc-button",C].filter(Boolean),w=window.digicommerceBlocksData?.checkoutUrl||"/checkout/";w=`${w}?id=${h}`,p&&(w+=`&variation=${p}`);let N=window.digicommerceBlocksData?.products||[],k=window.digicommerceBlocksData?.currencies||{},F=window.digicommerceBlocksData?.selectedCurrency||"USD",b=window.digicommerceBlocksData?.currencyPosition||"left",s=k[F]?.symbol||"$",l=N.find(e=>e.value===h),B=l?.variations||[],m=p?B[parseInt(p)-1]:null,t=(e,o=null)=>{if(!e&&e!==0)return"";let a=parseFloat(e).toFixed(2),P=a;if(o&&parseFloat(o)>0&&parseFloat(o)<parseFloat(e)){let x=parseFloat(o).toFixed(2),S=c(a);return`${c(x)} <del>${S}</del>`}return c(P)},c=e=>{switch(b){case"left":return`${s}${e}`;case"right":return`${e}${s}`;case"left_space":return`${s} ${e}`;case"right_space":return`${e} ${s}`;default:return`${s}${e}`}},r=f||l?.label||q("Buy Now","digicommerce");if(y&&l)if((l?.variations||[]).length>0){if(m){let a=t(m.price,m.salePrice);r+=` - ${a}`}}else{let a=t(l.price,l.sale_price);r+=` - ${a}`}return React.createElement("div",{className:"dc-button-wrapper"},React.createElement("a",{...g,href:w,className:[...v,g.className].filter(Boolean).join(" ")},React.createElement("span",{className:"dc-button-text",dangerouslySetInnerHTML:{__html:r}}),_&&React.createElement("span",{className:"dc-button-subtitle"},_)))}var{__:n}=wp.i18n,{useBlockProps:J,InspectorControls:K}=wp.blockEditor,{PanelBody:Q,RangeControl:L,SelectControl:ee,ToggleControl:T,Spinner:X,ComboboxControl:te,FormTokenField:E}=wp.components,{useSelect:Y}=wp.data;function V({attributes:$,setAttributes:i}){let{postsPerPage:h,columns:f,showTitle:y,showPrice:_,showButton:C,showPagination:p,selectedCategories:g,selectedTags:v}=$,w=J({className:"digicommerce-archive digicommerce py-12"}),{products:N,isLoading:k,categories:F,tags:b}=Y(t=>{let{getEntityRecords:c,isResolving:r}=t("core"),e={per_page:h===-1?100:h,_embed:!0,post_type:"digi_product"};return g?.length>0&&(e.digi_product_cat=g.join(",")),v?.length>0&&(e.digi_product_tag=v.join(",")),{products:c("postType","digi_product",e),isLoading:r("core","getEntityRecords",["postType","digi_product",e]),categories:c("taxonomy","digi_product_cat",{per_page:-1})||[],tags:c("taxonomy","digi_product_tag",{per_page:-1})||[]}},[h,g,v]),s=F?.map(t=>({label:t.name,value:t.id.toString()}))||[],l=b?.map(t=>({label:t.name,value:t.id.toString()}))||[],B=t=>{let c=t.meta?.digi_price_mode||"single",r=t.meta?.digi_price,e=t.meta?.digi_sale_price,o=t.meta?.digi_price_variations;if(c==="single"&&r)return e&&parseFloat(e)<parseFloat(r)?React.createElement("div",{className:"product-prices"},React.createElement("span",{className:"normal-price"},m(e)),React.createElement("span",{className:"regular-price"},m(r))):React.createElement("span",{className:"normal-price"},m(r));if(c==="variations"&&o?.length){let a=o.map(d=>({regular:parseFloat(d.price)||0,sale:parseFloat(d.salePrice)||0})),P=Math.min(...a.map(d=>d.regular)),x=a.filter(d=>d.sale&&d.sale<d.regular),S=x.length>0?Math.min(...x.map(d=>d.sale)):null;return S?React.createElement("div",{className:"product-prices"},React.createElement("span",{className:"from"},n("From:","digicommerce")),React.createElement("span",{className:"normal-price"},m(S)),React.createElement("span",{className:"regular-price"},m(P))):React.createElement("div",{className:"product-prices"},React.createElement("span",{className:"from"},n("From:","digicommerce")),React.createElement("span",{className:"price"},m(P)))}return null},m=t=>{let c=window.digicommerceBlocksData?.currencies||{},r=window.digicommerceBlocksData?.selectedCurrency||"USD",e=window.digicommerceBlocksData?.currencyPosition||"left",o=c[r]?.symbol||"$";if(!t&&t!==0)return"";let a=parseFloat(t).toFixed(2);switch(e){case"left":return`${o}${a}`;case"right":return`${a}${o}`;case"left_space":return`${o} ${a}`;case"right_space":return`${a} ${o}`;default:return`${o}${a}`}};return React.createElement(React.Fragment,null,React.createElement(K,null,React.createElement(Q,{title:n("Archive Settings","digicommerce")},React.createElement("div",{className:"components-base-control"},React.createElement("label",{className:"components-base-control__label"},n("Categories","digicommerce")),React.createElement(E,{value:g?s.filter(t=>g.includes(t.value)).map(t=>t.label):[],suggestions:s.map(t=>t.label),onChange:t=>{let c=t.map(r=>s.find(e=>e.label===r)?.value).filter(Boolean);i({selectedCategories:c})},placeholder:n("Select categories...","digicommerce"),maxSuggestions:10})),React.createElement("div",{className:"components-base-control"},React.createElement("label",{className:"components-base-control__label"},n("Tags","digicommerce")),React.createElement(E,{value:v?l.filter(t=>v.includes(t.value)).map(t=>t.label):[],suggestions:l.map(t=>t.label),onChange:t=>{let c=t.map(r=>l.find(e=>e.label===r)?.value).filter(Boolean);i({selectedTags:c})},placeholder:n("Select tags...","digicommerce"),maxSuggestions:10})),React.createElement(L,{label:n("Products per page","digicommerce"),value:h,onChange:t=>i({postsPerPage:t}),min:-1,max:100,help:n("-1 shows all products","digicommerce"),__nextHasNoMarginBottom:!0}),React.createElement(L,{label:n("Columns","digicommerce"),value:f,onChange:t=>i({columns:t}),min:1,max:6,__nextHasNoMarginBottom:!0}),React.createElement(T,{label:n("Show product title","digicommerce"),checked:y,onChange:t=>i({showTitle:t}),__nextHasNoMarginBottom:!0}),React.createElement(T,{label:n("Show product price","digicommerce"),checked:_,onChange:t=>i({showPrice:t}),__nextHasNoMarginBottom:!0}),React.createElement(T,{label:n("Show product button","digicommerce"),checked:C,onChange:t=>i({showButton:t}),__nextHasNoMarginBottom:!0}),React.createElement(T,{label:n("Show pagination","digicommerce"),checked:p,onChange:t=>i({showPagination:t}),__nextHasNoMarginBottom:!0}))),React.createElement("div",{...w},k?React.createElement("div",{style:"text-align: center"},React.createElement(X,null)):N?.length?React.createElement(React.Fragment,null,React.createElement("div",{className:`dc-inner col-${f}`},N.map(t=>React.createElement("article",{key:t.id,className:"product-card"},React.createElement("a",{href:"#",className:"product-link",onClick:c=>c.preventDefault()},t._embedded?.["wp:featuredmedia"]?.[0]?.source_url&&React.createElement("div",{className:"product-img"},React.createElement("img",{src:t._embedded["wp:featuredmedia"][0].source_url,alt:t._embedded["wp:featuredmedia"][0].alt_text||t.title.rendered})),React.createElement("div",{className:"product-content"},y&&React.createElement("h2",{dangerouslySetInnerHTML:{__html:t.title.rendered}}),_&&React.createElement(React.Fragment,null,B(t)))),C&&React.createElement("div",{className:"product-button"},React.createElement("a",{href:"#",onClick:c=>c.preventDefault()},n("View Product","digicommerce")))))),p&&React.createElement("nav",{className:"pagination"},React.createElement("ul",{className:"page-numbers"},React.createElement("span",{className:"page-numbers current"},"1"),React.createElement("span",{className:"page-numbers"},"2"),React.createElement("span",{className:"page-numbers"},"3")))):React.createElement("p",{className:"no-product"},n("No products found.","digicommerce"))))}var{registerBlockType:W}=wp.blocks,{__:M}=wp.i18n;W("digicommerce/button",{apiVersion:2,title:M("Button","digicommerce"),category:"digicommerce",icon:{src:React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",width:"24",height:"24"},React.createElement("path",{d:"M0 24C0 10.7 10.7 0 24 0L69.5 0c22 0 41.5 12.8 50.6 32l411 0c26.3 0 45.5 25 38.6 50.4l-41 152.3c-8.5 31.4-37 53.3-69.5 53.3l-288.5 0 5.4 28.5c2.2 11.3 12.1 19.5 23.6 19.5L488 336c13.3 0 24 10.7 24 24s-10.7 24-24 24l-288.3 0c-34.6 0-64.3-24.6-70.7-58.5L77.4 54.5c-.7-3.8-4-6.5-7.9-6.5L24 48C10.7 48 0 37.3 0 24zM128 464a48 48 0 1 1 96 0 48 48 0 1 1 -96 0zm336-48a48 48 0 1 1 0 96 48 48 0 1 1 0-96z"}))},description:M("Display a custom product button","digicommerce"),attributes:{productId:{type:"number"},customTitle:{type:"string"},showPrice:{type:"boolean",default:!0},subtitle:{type:"string"},customClass:{type:"string"},variationId:{type:"string"}},supports:{spacing:{margin:!0,padding:!0},typography:{fontSize:!0,lineHeight:!0,__experimentalFontFamily:!1,__experimentalFontStyle:!0,__experimentalFontWeight:!0,__experimentalLetterSpacing:!0,__experimentalTextTransform:!0,__experimentalTextDecoration:!1},align:["full","left","right","center"],__experimentalBorder:{color:!0,radius:!0,style:!0,width:!0},color:{text:!0,background:!0,gradients:!0}},example:{attributes:{customTitle:M("My Product","digicommerce"),showPrice:!0,subtitle:"One-time purchase",customClass:""},viewportWidth:400},edit:D,save:I});W("digicommerce/archives",{apiVersion:2,title:M("Archives","digicommerce"),category:"digicommerce",icon:{src:React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",width:"24",height:"24"},React.createElement("path",{d:"M88 64c4.4 0 8 3.6 8 8l0 48c0 4.4-3.6 8-8 8l-48 0c-4.4 0-8-3.6-8-8l0-48c0-4.4 3.6-8 8-8l48 0zM40 32C17.9 32 0 49.9 0 72l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40L40 32zM88 224c4.4 0 8 3.6 8 8l0 48c0 4.4-3.6 8-8 8l-48 0c-4.4 0-8-3.6-8-8l0-48c0-4.4 3.6-8 8-8l48 0zM40 192c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0zm0 192l48 0c4.4 0 8 3.6 8 8l0 48c0 4.4-3.6 8-8 8l-48 0c-4.4 0-8-3.6-8-8l0-48c0-4.4 3.6-8 8-8zM0 392l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zM248 64c4.4 0 8 3.6 8 8l0 48c0 4.4-3.6 8-8 8l-48 0c-4.4 0-8-3.6-8-8l0-48c0-4.4 3.6-8 8-8l48 0zM200 32c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0zm0 192l48 0c4.4 0 8 3.6 8 8l0 48c0 4.4-3.6 8-8 8l-48 0c-4.4 0-8-3.6-8-8l0-48c0-4.4 3.6-8 8-8zm-40 8l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zm88 152c4.4 0 8 3.6 8 8l0 48c0 4.4-3.6 8-8 8l-48 0c-4.4 0-8-3.6-8-8l0-48c0-4.4 3.6-8 8-8l48 0zm-48-32c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0zM360 64l48 0c4.4 0 8 3.6 8 8l0 48c0 4.4-3.6 8-8 8l-48 0c-4.4 0-8-3.6-8-8l0-48c0-4.4 3.6-8 8-8zm-40 8l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40zm88 152c4.4 0 8 3.6 8 8l0 48c0 4.4-3.6 8-8 8l-48 0c-4.4 0-8-3.6-8-8l0-48c0-4.4 3.6-8 8-8l48 0zm-48-32c-22.1 0-40 17.9-40 40l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0zm0 192l48 0c4.4 0 8 3.6 8 8l0 48c0 4.4-3.6 8-8 8l-48 0c-4.4 0-8-3.6-8-8l0-48c0-4.4 3.6-8 8-8zm-40 8l0 48c0 22.1 17.9 40 40 40l48 0c22.1 0 40-17.9 40-40l0-48c0-22.1-17.9-40-40-40l-48 0c-22.1 0-40 17.9-40 40z"}))},description:M("Display a grid of products with customizable settings","digicommerce"),edit:V,save:()=>null});})();
