(()=>{document.addEventListener("DOMContentLoaded",function(){document.querySelector(".digicommerce-setup-wizard")&&(document.body.style.overflow="hidden");let n=document.querySelectorAll(".digicommerce-setup-content"),m=document.querySelectorAll(".continue");n.length&&n.forEach((e,r)=>{r===0?e.classList.remove("hidden"):e.classList.add("hidden")});let d=document.querySelector(".business-form");d&&d.addEventListener("submit",function(e){e.preventDefault();let r=this.closest(".digicommerce-setup-content"),c=Array.from(n).indexOf(r),t=this.querySelector('button[type="submit"]'),u=t.textContent;t.textContent=digicommerceSetup.i18n.saving,t.disabled=!0;let i=new FormData(this);i.append("action","digicommerce_setup_wizard_save"),i.append("nonce",digicommerceSetup.nonce),i.append("subscribe_newsletter",document.getElementById("subscribe_newsletter").checked),fetch(digicommerceSetup.ajaxurl,{method:"POST",body:i,credentials:"same-origin",headers:{Accept:"application/json"}}).then(o=>{if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return o.text()}).then(o=>{try{let s=JSON.parse(o);s.success?(r.classList.add("hidden"),n[c+1]&&n[c+1].classList.remove("hidden")):(console.error("Server returned error:",s),alert(digicommerceSetup.i18n.error))}catch(s){console.error("JSON parse error:",s),alert(digicommerceSetup.i18n.error)}t.textContent=u,t.disabled=!1}).catch(o=>{console.error("Fetch error:",o),alert(digicommerceSetup.i18n.error),t.textContent=u,t.disabled=!1})}),m.forEach(e=>{e.addEventListener("click",function(r){r.preventDefault();let c=this.closest(".digicommerce-setup-content"),t=Array.from(n).indexOf(c);c.classList.add("hidden"),n[t+1]&&n[t+1].classList.remove("hidden")})}),document.querySelectorAll(".digicommerce__search").forEach(e=>{new Choices(e,{searchEnabled:!0,searchPlaceholderValue:e.dataset.placeholder||digicommerceSetup.i18n.select,searchResultLimit:-1})});let a=document.querySelector(".skip");a&&a.addEventListener("click",async e=>{e.preventDefault();try{let c=await(await fetch(digicommerceSetup.ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"digicommerce_skip_setup",nonce:digicommerceSetup.nonce})})).json();if(c.success&&c.data.redirect)window.location.href=c.data.redirect;else throw new Error(digicommerceSetup.i18n.error)}catch(r){alert(r.message||digicommerceSetup.i18n.error)}})});})();
