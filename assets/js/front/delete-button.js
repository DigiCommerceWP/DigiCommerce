(()=>{document.addEventListener("DOMContentLoaded",function(){let r=document.querySelectorAll(".remove-item-btn");r&&r.forEach(a=>{a.addEventListener("click",async function(c){c.preventDefault();let n=this.dataset.index;try{let t=await(await fetch(digicommerceVars.ajaxurl,{method:"POST",body:new URLSearchParams({action:"digicommerce_remove_cart_item",index:n,nonce:digicommerceVars.order_nonce}),headers:{"Content-Type":"application/x-www-form-urlencoded"}})).json();if(t.success&&t.data){if(this.closest(".cart-item").remove(),document.querySelectorAll(".remove-item-btn").forEach((e,i)=>{e.dataset.index=i}),document.querySelectorAll(".cart-item").length){let e=document.getElementById("cart-subtotal");e&&(e.innerHTML=t.data.formatted_prices.subtotal),window.vatCalculator&&window.vatCalculator.updateFromSubtotal()}else{let e=document.querySelector(".digicommerce-checkout");e&&digicommerceVars.empty_cart_template&&(e.innerHTML=digicommerceVars.empty_cart_template)}if(digicommerceVars.proVersion&&digicommerceVars.enableSideCart){let e=new CustomEvent("digicommerce_cart_updated");document.dispatchEvent(e)}}else console.error("Remove cart item failed:",t),alert(t.data?.message||"Failed to remove item.")}catch(o){console.error("Cart removal error:",o),alert("An error occurred. Please try again.")}})})});})();
